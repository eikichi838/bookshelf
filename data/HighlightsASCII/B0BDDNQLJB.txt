---
kindle-sync:
  bookId: '2062'
  title: 因果推論の科学　「なぜ？」の問いにどう答えるか (文春e-book)
  author: 'ジューディア・パール, ダナ・マッケンジー, 夏目 大, and 松尾 豊・監修解説'
  asin: B0BDDNQLJB
  lastAnnotatedDate: Invalid date
  bookImageUrl: 'https://m.media-amazon.com/images/I/710QqAtESpL._SY160.jpg'
  highlightsCount: 39
---
# 因果推論の科学　「なぜ？」の問いにどう答えるか
## Metadata
* Author: [ジューディア・パール, ダナ・マッケンジー, 夏目 大, and 松尾 豊・監修解説](https://www.amazon.comundefined)
* ASIN: B0BDDNQLJB
* Reference: https://www.amazon.com/dp/B0BDDNQLJB
* [Kindle link](kindle://book?action=open&asin=B0BDDNQLJB)

## Highlights
交絡因子 — location: [279](kindle://book?action=open&asin=B0BDDNQLJB&location=279) ^ref-64713

---
ファスト＆スロー』（ — location: [1269](kindle://book?action=open&asin=B0BDDNQLJB&location=1269) ^ref-15818

---
を、Ｘ — location: [1725](kindle://book?action=open&asin=B0BDDNQLJB&location=1725) ^ref-56357

---
がＹの原因だと証明すること、あるいはＹの原因を一から見つけ出すことだと考えていた。この誤った考え方は、今でも多くの人に見受けられる。だが、それは因果分析ではなく、「因果探索」が扱う問題だ。 — location: [1725](kindle://book?action=open&asin=B0BDDNQLJB&location=1725) ^ref-48665

---
以上、三つのジャンクション──チェーン、フォーク、コライダー──は、因果のはしごの一段目と二段目を隔てるドアの鍵穴のようなものだ。 — location: [2484](kindle://book?action=open&asin=B0BDDNQLJB&location=2484) ^ref-3817

フォーク（条件付きにすると擬似相関に独立性を生み出すことができる）、コライダーの考え方（条件付きにしてしまうと逆相関が生まれる）が興味深い

---
一方、ベイジアンネットワークは、そのような人為的な介入に対応するようにはできていない。「見ること」と「行動すること」の区別もできないし、もっと言えば、フォークとチェーンの区別もできない。チェーンでもフォークでも、Ａに変化が観察された場合、それに伴ってＣに変化が起きるだろうと予測はできるが、「Ａを人為的に操作すること」の結果は予測できないのだ。 — location: [2737](kindle://book?action=open&asin=B0BDDNQLJB&location=2737) ^ref-15335

---
不思議なのは、統計学者の中には、このように交絡因子になりそうな変数の調整をすることの重要性を過大評価、あるいは過小評価している人が多いことだ。過大評価する人は、必要以上に多くの変数について調整をしてしまう。ときには調整すべきでない変数まで調整してしまう — location: [2881](kindle://book?action=open&asin=B0BDDNQLJB&location=2881) ^ref-55008

---
さえある。最近、政治ブロガーのエズラ・クラインが、「過剰な調整」についてわかりやすく説明している文章を読んだ。クラインはこんなふうに書いている。「論文を読んでいると、『本調査では以下のものを調整した』と書かれたあとに、リストがずらっと並んでいるのをよく目にする。リストは長ければ長いほど良い。収入、年齢、人種、宗教、身長、髪の色、性的嗜好、クロスフィットというトレーニングをしているかどうか、親からの愛情、コーク派かペプシ派かなど、何でもありだ。確かに、調整する変数が多くなるほど、調査結果は揺るぎないものになる — location: [2883](kindle://book?action=open&asin=B0BDDNQLJB&location=2883) ^ref-62532

---
公平を期すために言っておくと、アボットらの研究チームがこれほど慎重になるには十分な理由があったのかもしれない。なにしろ、これは初回の研究であり、標本の数も少なく限定的なものだったからだ。だが一方で、この慎重さは、標本のサイズや制限の問題にとどまらない、研究者の一般的な態度も反映している。研究者は、観察研究（被験者が自身の行動を選べる研究）によって因果関係に関わる主張が明らかになることは決してないと教え込まれてきたのだ。しかし、私から見れば、 — location: [2968](kindle://book?action=open&asin=B0BDDNQLJB&location=2968) ^ref-46799

---
はあまりにも慎重すぎる。 — location: [2972](kindle://book?action=open&asin=B0BDDNQLJB&location=2972) ^ref-40657

---
ｄｏ演算子には、「肥料」に向かう矢印をすべて消去して、この変数を強制的に特定の値（ここでは １）に固定する効果 — location: [3078](kindle://book?action=open&asin=B0BDDNQLJB&location=3078) ^ref-23213

---
がある。 — location: [3079](kindle://book?action=open&asin=B0BDDNQLJB&location=3079) ^ref-40626

---
たとえば、処理群と対照群のZ = 0になっている被験者だけを見たとしたら、Ｘの効果を完全に阻害することになる。Ｘは、Ｚを変えることで作用するからだ。そのため、Z = 0にしてしまうと、ＸはＹに何も影響しないという結論を出すことになる。エズラ・クラインの言う「その調査の目的の変数そのものを調整して — location: [3197](kindle://book?action=open&asin=B0BDDNQLJB&location=3197) ^ref-30293

---
交絡とはP（Y|do（X））とP（Y|X）の間に差異を生じさせるものと定義したことを思い出そう。ｄｏ演算子は、Ｘに向かうすべての矢印を — location: [3267](kindle://book?action=open&asin=B0BDDNQLJB&location=3267) ^ref-10861

---
こんな状況が現実に生じることは極端に少ないだろうと言った人も何人かいた。実はそんなことはない。たとえば、シートベルトの使用（Ｂ）は、喫煙（Ｘ）や肺疾患（Ｙ）に対しては何ら因果効果をもたらさない。それは単に、社会規範（Ａ）や、安全、健康関連対策（Ｃ）への個人の態度を知るための指標の一つにすぎない。そうした態度の中には、肺疾患（Ｙ）へのかかりやすさに影響するものもあるかもしれない。実際、シートベルトの使用と、Ｘ、Ｙの両方には相関関係が見られることがわかっている。 — location: [3332](kindle://book?action=open&asin=B0BDDNQLJB&location=3332) ^ref-34609

---
ば、「出場者のドア選択」と「新車の位置」の間には直接的な因果関係はない。また共通の原因を通じた間接的な因果関係もない。そのため、両者に確率的な関連があることをまったく不可解なことと感じてしまうのである。 — location: [4022](kindle://book?action=open&asin=B0BDDNQLJB&location=4022) ^ref-36130

---
バークソンのパラドックス — location: [4029](kindle://book?action=open&asin=B0BDDNQLJB&location=4029) ^ref-20641

---
はじめから「二枚とも裏」という事象を排除しているのである。それによって、外見と人柄の間に見せかけの負の相関関係が生じている。実際には、外見が魅力的ではない人は、魅力的な人に比べて人柄が良いわけでも悪いわけでもない。悲しいことかもしれないがそれが真実だ──しかし、それには気づかない場合も多い。なぜかといえば、人柄も外見もどちらも良くない人とは最初からデートをしないから — location: [4107](kindle://book?action=open&asin=B0BDDNQLJB&location=4107) ^ref-35350

---
当然原理が妥当だと言えるのは、実業家の決断が大統領選挙の結果に絶対に影響しないと言い切れるときだけだ。 — location: [4235](kindle://book?action=open&asin=B0BDDNQLJB&location=4235) ^ref-24710

---
誤解してほしくないのは、データを集約するのは常に良くない、データは常に個別に見るべき、と言っているわけではないことだ。良いかどうかはデータがどのような過程で生成されるかで変わってくる。モンティ・ホールのパラドックスでは、ゲームのルールを変更すれば、 — location: [4271](kindle://book?action=open&asin=B0BDDNQLJB&location=4271) ^ref-35349

---
絡因子ではなく媒介因子となっている。 — location: [4291](kindle://book?action=open&asin=B0BDDNQLJB&location=4291) ^ref-13624

---
この手法を使う場合には、介入による平均の因果効果を測定することになる。そのためにはまず、交絡解消因子の各層（各レベル）での効果を推定し、その後に各層の加重平均を計算する。各層の重み付けは、それぞれが全体に対して占める割合に基づいて行う。たとえば、交絡解消因子が「性別」だったとしたら、まずは男性と女性のそれぞれについて因果効果を推定したのちに、その二つの平均を取る。母集団の半数が男性、半数が女性（通常はそうだ）になっていれば、単純に平均を求めればいい。しかし、両者の割合が異なっていれば──仮に三分の二が男性、三分の一が女性であれば──平均の因果効果を推定するためには、その割合に基づいた加重平均を求める必要がある。 　ここでバックドア基準は、交絡解消因子の各層の因果効果が、まさに各層で観察される傾向以外の何ものでもないと保証する役割を果たす。それが保証されれば、因果効果は、データから層ごとに推定することができる。バックドア基準がなければ、どのような調整であれ、それが正当なものだと保証することができなくなる。 　第六章で取りあげた架空の薬の例は、考えられる限り最も単純な状況だろう──処理変数（ドラッグＤ）が一つ、結果変数（心臓発作）が一つ、そして交絡因子（性別）が一つあり、そのすべてが二値変数という状況だ。この例から、二つの性別層の条件付き確率P（heart attack|drug）の加重平均をどのようにして求めればいいのかがわかる。これは単純な例だが、同様の方法は、交絡因子（あるいは交絡解消因子）が複数あり、層も三層以上あるような複雑な状況にも簡単に応用できる。 — location: [4512](kindle://book?action=open&asin=B0BDDNQLJB&location=4512) ^ref-60707

---
係数ａは、すでにＺについて調整済みの、Ｘに対するＹの回帰係数になるのである（これを偏回帰係数と呼び、rYX.Z と表記する）。 — location: [4557](kindle://book?action=open&asin=B0BDDNQLJB&location=4557) ^ref-3655

---
フロントドア調整」と呼ぶ。フロントドア調整がバックドア調整と違うのは、一つではなく二つの変数（「喫煙」と「タール」）について調整をすること、その二つの変数がバックドア経路ではなく、「喫煙」から「がん」にいたるフロントドア経路にあることだ。 — location: [4646](kindle://book?action=open&asin=B0BDDNQLJB&location=4646) ^ref-35368

---
必ず専門家の意見を聞き、それに従うようにしている。実のところ、因果ダイアグラムの良いところは、それを作った人間が何を前提に思考をしているかが可視化されることではないかと思う。そうなっていれば、専門家や政策立案者がそれを見て自分の意見を述べやすくなる。 — location: [4682](kindle://book?action=open&asin=B0BDDNQLJB&location=4682) ^ref-1323

---
ｄｏ演算子の完全な排除に成功すれば、観察データをもとに因果効果の推定ができるようになる。そして、因果のはしごの一段目から二段目へと上がることができるのだ。 — location: [4747](kindle://book?action=open&asin=B0BDDNQLJB&location=4747) ^ref-13732

---
パス係数の積abだ。したがって、ここではab = rZY とa = rZX という二つの方程式が成り立つことになる。そして、一つ目の方程式を二つ目の方程式で割ると、ＸのＹに対する因果効果ｂが得られる。b = rZY/rZX ということだ。 — location: [5129](kindle://book?action=open&asin=B0BDDNQLJB&location=5129) ^ref-20154

---
その前に、使用する操作変数が必要な前提条件をすべて満たしているかを確認しておこう。まず、操作変数Ｚは、交絡因子から独立しているか。Ｚをランダム化できれば、その問いへの答えは「イエス」となる（第四章で触れたとおり、ランダム化は、変数を交絡因子の影響から — location: [5207](kindle://book?action=open&asin=B0BDDNQLJB&location=5207) ^ref-16907

---
するための優れた方法である）。次に、ＺからＹには直接の経路が存在するか。常識で考えれば、Ｚの値がランダムに決まることが、コレステロール（Ｙ）の値に直接影響を与えることはあり得ない。つまり、答えは「ノー」だ。最後に、ＺとＸの間に強い関係はあるか。データをよく確認すればわかるが、答えは「イエス」である。操作変数を利用する際には、必ずこの三つの問いの答えを確認しなくてはならない。 — location: [5210](kindle://book?action=open&asin=B0BDDNQLJB&location=5210) ^ref-10592

---
つまり、四七・三パーセントだ。しかし、この数字には — location: [5230](kindle://book?action=open&asin=B0BDDNQLJB&location=5230) ^ref-46113

---
効果が含まれている可能性があるため、補正が必要になる。プラシーボ効果がどのくらいかは、中央列の三行目を見れば推定できる。「薬を服用するよう指示されなかった人」というのは、ここでは正確には「（本人はそうとは知らずに）プラシーボを服用するよう指示された人」である。そして、実際にプラシーボを与えられた人のうち、コレステロール値が改善した人が八・一パーセントいる。したがって、コレスチラミンを服用した人の中にも、プラシーボ効果によって改善した人が同程度いると考えられる。そこで、四七・三から八・一を引き、三九・二パーセントに補正する。 — location: [5231](kindle://book?action=open&asin=B0BDDNQLJB&location=5231) ^ref-7038

---
この考え方は根本的に誤っている。この考え方で主となるのはデータであり、モデルではない。欠損を埋める際には、必ず表内の既存データが利用される。すでに見てきたとおり、このようにデータを基本とした手法（因果のはしごの一段目の手法）にはどうしても限界があり、反事実的な問い（因果のはしごの三段目の問い）にはまったく答えることができない。 — location: [5676](kindle://book?action=open&asin=B0BDDNQLJB&location=5676) ^ref-41350

---
まず重要なのは、「経験年数」という変数は「教育水準」という変数に影響を受ける可能性が高いということである。 — location: [5685](kindle://book?action=open&asin=B0BDDNQLJB&location=5685) ^ref-33986

多重共線性の話？

---
もし、この結果についての知識がないのなら、P（Yx=0 = 0）とP（Y = 0|do（X = 0））の間には何の違いもない。どちらの式も「通常の条件下で、非常口を塞がないようにした場合にジュディが生存し続ける確率」を表現しているだけである。火災やジュディの死亡、非常口を塞ぐことには言及していない。しかし、結果についての知識があると、確率の評価が変わることがある。X = 1とY = 1（結果）が観察されていれば、P（Yx=0 = 0|X = 1, Y = 1）とP（Yx=0 = 0|X = 1）は同じにはならない。ジュディが死亡した（Y = 1）という結果を知っていれば、非常口が塞がれていた（X = 1）という知識しかない場合には得られない情報が得られたことになる。一つには、これは火災の大きさを示す証拠であるとも言える。 　また、P（Yx=0 = 0|X = 1, Y = 1）を、ｄｏ演算式で表現する方法はないということも言える。これは少々、わかりにくいかもしれないが、反事実（因果のはしごの三段目）が、介入（因果のはしごの二段目）の上に位置するということの数学的証明でもある。 — location: [5971](kindle://book?action=open&asin=B0BDDNQLJB&location=5971) ^ref-3642

---
統計学者たちがなぜ長年、間接効果をうまく定義できなかったのか、その理由はわかるだろう。単なる反事実ですら彼らにとっては突拍子もないものだったのに、間接効果を扱うには、二重に入れ子になった反事実が必要になるのだ。 — location: [6675](kindle://book?action=open&asin=B0BDDNQLJB&location=6675) ^ref-778

---
から六（2×3 = 6）に上がるが、六は閾値未満なので、求職者は就職しない。よって「 — location: [6786](kindle://book?action=open&asin=B0BDDNQLJB&location=6786) ^ref-2093

---
NIE = ∑ m［P（M = m|X = 1）－P（M = m|X = 0）］×P（Y = 1|X = 0, M = m）　（式９・５） — location: [6926](kindle://book?action=open&asin=B0BDDNQLJB&location=6926) ^ref-28373

---
因果ダイアグラムは図９・12 のように描き直すこともできる。この場合、喫煙習慣は、喫煙遺伝子と肺がんの間の媒介因子ということになる。 — location: [7104](kindle://book?action=open&asin=B0BDDNQLJB&location=7104) ^ref-60625

---
本書の内容は、極めて深い洞察に満ち、示唆に富んでいる。そして、非常に哲学的で、かつ、著者の独特の世界観が色濃く反映されている。 — location: [7823](kindle://book?action=open&asin=B0BDDNQLJB&location=7823) ^ref-51405

---
